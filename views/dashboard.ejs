<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("./partials/head.ejs") %>
    <title>User Dashboard</title>
  </head>
  <body>
    <%- include("./partials/nav.ejs") %>

    <div class="container mt-4">
      <div class="text-center mb-4">
        <h2 class="fw-bold text-primary">Welcome, <%= user.fullName %> ðŸ‘‹</h2>
        <p class="text-muted">
          Hereâ€™s a quick overview of your activity on Blogify
        </p>
      </div>

      <div class="row g-4 mb-5">
        <div class="col-md-4">
          <div class="card text-center p-3">
            <div class="card-body">
              <i class="bi bi-journal-richtext text-primary fs-1 mb-2"></i>
              <h4 class="fw-bold"><%= blogs.length %></h4>
              <p class="text-muted mb-0">Total Blogs</p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card text-center p-3">
            <div class="card-body">
              <i class="bi bi-hand-thumbs-up text-success fs-1 mb-2"></i>
              <h4 class="fw-bold"><%= count %></h4>
              <p class="text-muted mb-0">Total Likes</p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card text-center p-3">
            <div class="card-body">
              <i class="bi bi-chat-left-text text-warning fs-1 mb-2"></i>
              <h4 class="fw-bold"><%= commentsCount %></h4>
              <p class="text-muted mb-0">Total Comments</p>
            </div>
          </div>
        </div>
      </div>

      <div class="card p-4 mb-5">
        <h4 class="fw-bold text-primary mb-3">
          <i class="bi bi-pencil-square me-2"></i> Your Blogs
        </h4>
        <% if (blogs.length > 0) { %>
        <div class="table-responsive">
          <table class="table align-middle">
            <thead class="table-light">
              <tr>
                <th>Title</th>
                <th>Likes</th>
                <th>Comments</th>
                <th>Created</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <% blogs.forEach(blog => { %>
              <tr>
                <td>
                  <a
                    href="/blog/<%= blog._id %>"
                    class="fw-semibold text-decoration-none text-dark"
                  >
                    <%= blog.title %>
                  </a>
                </td>
                <td>
                  <span class="badge bg-primary"><%= blog.likes.length %></span>
                </td>
                <td>
                  <span class="badge bg-secondary">
                    <%= commentMap.get(blog) %>
                  </span>
                </td>
                <td><%= blog.createdAt.toDateString() %></td>
                <td>
                  <a
                    href="/blog/<%= blog._id %>"
                    class="btn btn-sm btn-outline-primary"
                  >
                    View
                  </a>
                </td>
              </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
        <% } else { %>
        <p class="text-muted">You havenâ€™t posted any blogs yet.</p>
        <% } %>
      </div>
    </div>

    <%- include("./partials/script.ejs") %>
  </body>
</html>
